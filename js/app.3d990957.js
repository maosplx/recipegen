(function(){"use strict";var e={7167:function(e,t,o){var s=o(5130),l=o(6768),n=o(4232);const a=e=>((0,l.Qi)("data-v-e153528c"),e=e(),(0,l.jt)(),e),i={class:"container-fluid"},r={class:"row mx-2"},c={class:"form-group col-sm"},d={class:"form-group col-sm"},u={class:"form-group col-sm"},p={id:"doctorList"},m=["value"],f=a((()=>(0,l.Lk)("div",{class:"col-auto me-2"},[(0,l.Lk)("button",{class:"btn btn-primary align-top shadow shadow-lg",type:"submit"},"Печать")],-1))),h=a((()=>(0,l.Lk)("br",null,null,-1))),g={class:"container-fluid"},b={class:"row row-cols-4"},k={class:"list-group med-container shadow shadow-lg"},L=["for"],v={class:"btn-group btn-group-sm ms-1 dosage-group flex-wrap"},y=["id","onUpdate:modelValue","value"],w=["for"],C=["id"],D={class:"input-group-text"},M=["id","onUpdate:modelValue"],x=["value"],U=a((()=>(0,l.Lk)("label",{class:"input-group-text"},"мес. по",-1))),_=["onUpdate:modelValue"],V=a((()=>(0,l.Lk)("label",{class:"input-group-text"},"шт.",-1))),E=a((()=>(0,l.Lk)("br",null,null,-1))),X=["onUpdate:modelValue"],F=a((()=>(0,l.Lk)("br",null,null,-1))),N={key:0,class:"list-group med-container shadow shadow-lg"},O={class:"list-group-item med-container-item"},j=a((()=>(0,l.Lk)("label",{class:"form-check-label custom-med-title"},"Добавить свой",-1))),K=["id"],A=["id"],I=["onUpdate:modelValue"],S=["selected"],q=["onUpdate:modelValue"],J=["onUpdate:modelValue"],T=["id"],P=a((()=>(0,l.Lk)("label",{class:"input-group-text"}," на ",-1))),Q=["id","onUpdate:modelValue"],G=["value"],R=a((()=>(0,l.Lk)("label",{class:"input-group-text"},"мес. по",-1))),z=["onUpdate:modelValue"],B=a((()=>(0,l.Lk)("label",{class:"input-group-text"},"шт.",-1))),H=["onClick"],Y=a((()=>(0,l.Lk)("svg",{class:"bi bi-x-lg",fill:"currentColor",height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg"},[(0,l.Lk)("path",{d:"M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"})],-1))),$=[Y],W=a((()=>(0,l.Lk)("br",null,null,-1))),Z=["onUpdate:modelValue"];function ee(e,t,o,a,Y,ee){return(0,l.uX)(),(0,l.CE)("div",i,[(0,l.Lk)("form",{class:"mt-4",onSubmit:t[4]||(t[4]=(0,s.D$)((e=>ee.submitForm()),["prevent"]))},[(0,l.Lk)("div",r,[(0,l.Lk)("div",c,[(0,l.bo)((0,l.Lk)("input",{id:"patientName","onUpdate:modelValue":t[0]||(t[0]=e=>Y.patientName=e),autofocus:"",class:"form-control shadow",placeholder:"Пациент",required:"",type:"text"},null,512),[[s.Jo,Y.patientName]])]),(0,l.Lk)("div",d,[(0,l.bo)((0,l.Lk)("input",{id:"dob","onUpdate:modelValue":t[1]||(t[1]=e=>Y.dob=e),class:"form-control shadow",placeholder:"01.01.2000",required:"",type:"date"},null,512),[[s.Jo,Y.dob]])]),(0,l.Lk)("div",u,[(0,l.bo)((0,l.Lk)("input",{id:"doctorName","onUpdate:modelValue":t[2]||(t[2]=e=>Y.doctorName=e),autocomplete:"off",class:"form-control shadow",list:"doctorList",placeholder:"Врач",required:"",type:"text"},null,512),[[s.Jo,Y.doctorName]]),(0,l.Lk)("datalist",p,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(Y.doctorsList,(e=>((0,l.uX)(),(0,l.CE)("option",{key:e,value:e},null,8,m)))),128))])]),f]),h,(0,l.Lk)("div",g,[(0,l.Lk)("div",b,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(ee.groupedMedications,((e,o)=>((0,l.uX)(),(0,l.CE)("div",{key:o,class:"col"},[(0,l.Lk)("ul",k,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e,(e=>((0,l.uX)(),(0,l.CE)("li",{key:e.id,class:(0,n.C4)([{med_selected:e.selectedDosages.length},"list-group-item med-container-item"])},[(0,l.Lk)("label",{class:(0,n.C4)([{label_active:e.selectedDosages.length},"form-check-label drug-label"]),for:"medication_"+e.id},(0,n.v_)(e.name),11,L),(0,l.Lk)("div",v,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.dosages,((t,o)=>((0,l.uX)(),(0,l.CE)(l.FK,{key:t.id},[(0,l.bo)((0,l.Lk)("input",{id:"medication"+e.id+"prescription_"+o,"onUpdate:modelValue":t=>e.selectedDosages=t,value:t,class:"btn-check",type:"checkbox"},null,8,y),[[s.lH,e.selectedDosages]]),(0,l.Lk)("label",{for:"medication"+e.id+"prescription_"+o,class:"btn btn-outline-primary shadow shadow-sm flex-shrink-1"},(0,n.v_)(1e3*parseFloat(t.dosage.replace(/,/g,"."))),9,w)],64)))),128))]),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.selectedDosages,((t,o)=>((0,l.uX)(),(0,l.CE)(l.FK,{key:t.id},[(0,l.Lk)("div",{id:"medication"+e.id+"prescription_"+o+"field",class:"input-group input-group-sm"},[(0,l.Lk)("label",D,(0,n.v_)(t.dosage)+" на ",1),(0,l.bo)((0,l.Lk)("select",{id:"medication_"+e.id+"_months","onUpdate:modelValue":e=>t.prescriptionMonths=e,class:"form-select form-select-sm prescription-months"},[((0,l.uX)(),(0,l.CE)(l.FK,null,(0,l.pI)(12,(e=>(0,l.Lk)("option",{key:e,value:e},(0,n.v_)(e),9,x))),64))],8,M),[[s.u1,t.prescriptionMonths]]),U,(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":e=>t.quantity=e,class:"form-control form-control-sm"},null,8,_),[[s.Jo,t.quantity]]),V,E],8,C),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":e=>t.signature=e,class:(0,n.C4)([{"mb-2":o+1<e.selectedDosages.length},"form-control form-control-sm signature-text"])},null,10,X),[[s.Jo,t.signature]])],64)))),128))],2)))),128))]),F,0===o?((0,l.uX)(),(0,l.CE)("ul",N,[(0,l.Lk)("li",O,[(0,l.Lk)("div",null,[j,(0,l.Lk)("button",{class:"btn btn-outline-primary btn-sm ml-3 px-3 add-new",onClick:t[3]||(t[3]=e=>ee.addCustom())},"+")])]),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(Y.medications.customMeds,((e,t)=>((0,l.uX)(),(0,l.CE)("li",{key:t,id:"custom"+t,class:(0,n.C4)([{med_selected:e},"list-group-item med-container-item"])},[(0,l.Lk)("div",{id:"medication"+t+"prescription",class:"input-group input-group-sm"},[(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":t=>e.form[0]=t,class:"form-select form-select-sm form-form"},[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(["Tab.","Caps.","Sol."],((e,t)=>((0,l.uX)(),(0,l.CE)("option",{key:e,selected:0===t},(0,n.v_)(e),9,S)))),128))],8,I),[[s.u1,e.form[0]]]),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t=>e.name=t,class:"form-control form-control-sm custom-med-name w-50",placeholder:"Sepuli"},null,8,q),[[s.Jo,e.name]]),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t=>e.selectedDosages[0].dosage=t,class:"form-control form-control-sm custom-med-dose",placeholder:"0,5"},null,8,J),[[s.Jo,e.selectedDosages[0].dosage]])],8,A),(0,l.Lk)("div",{id:"medication"+t+"prescription2",class:"input-group input-group-sm"},[P,(0,l.bo)((0,l.Lk)("select",{id:"medication_"+t+"_months","onUpdate:modelValue":t=>e.selectedDosages[0].prescriptionMonths=t,class:"form-select form-select-sm cus-prescription-months"},[((0,l.uX)(),(0,l.CE)(l.FK,null,(0,l.pI)(12,(e=>(0,l.Lk)("option",{key:e,value:e},(0,n.v_)(e),9,G))),64))],8,Q),[[s.u1,e.selectedDosages[0].prescriptionMonths]]),R,(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t=>e.selectedDosages[0].quantity=t,class:"form-control form-control-sm"},null,8,z),[[s.Jo,e.selectedDosages[0].quantity]]),B,(0,l.Lk)("button",{class:"btn btn-sm btn-danger",onClick:e=>Y.medications.customMeds.splice(t,1)},$,8,H),W],8,T),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":t=>e.selectedDosages[0].signature=t,class:(0,n.C4)([{"mb-2":t+1<Y.medications.customMeds.length},"form-control form-control-sm signature-text"]),placeholder:"По 2 сепульки 3 раза в день"},null,10,Z),[[s.Jo,e.selectedDosages[0].signature]])],10,K)))),128))])):(0,l.Q3)("",!0)])))),128))])])],32)])}o(4114),o(4603),o(7566),o(8721);var te=o(8355),oe=o(2623),se=o(2475),le=o.n(se),ne={data(){return{patientName:"",dob:"",doctorName:"",isAdult:!0,medications:[],selectedMedications:[],dosages:[],prescriptionMonths:3,defaultDosage:"",defaultQuantity:0,defaultSignature:"",selectedQuantity:0,medicationGroup:0,signature:"",possibleDoses:[],doctorsList:[],pdfVisible:!1,pdf:null}},created(){this.fetchMedications(),this.fetchDoctors();let e=new URLSearchParams(window.location.search);if(console.log(e),e.size>0){this.doctorName=e.get("doctorName");let t=e.get("dob").split(".");this.dob=t[2]+"-"+t[1]+"-"+t[0],this.patientName=e.get("patientName")}},watch:{dob(){this.isAdult=this.age_check()}},computed:{groupedMedications(){const e={};return this.medications.forEach((t=>{e[t.medicationGroup]||(e[t.medicationGroup]=[]),e[t.medicationGroup].push(t)})),Object.values(e)}},methods:{age_check(){let e=new Date(this.dob),t=new Date,o=new Date(t.getFullYear()-18,t.getMonth(),t.getDay());return o.getTime()>e.getTime()},addCustom(){let e={name:"",selectedDosages:[{dosage:"",prescriptionMonths:3,quantity:30,signature:""}],form:["Tab."]};console.log(e),this.medications.customMeds.push(e)},fetchMedications(){(0,oe.Ay)(te.A,{retries:3,retryDelay:oe.Ay.exponentialDelay,retryCondition:()=>!0}),te.A.get("http://localhost:5050/api/medications").then((e=>{this.medications=e.data,this.medications.customMeds=[],this.medications.forEach((e=>{e.dosages.map((e=>e["prescriptionMonths"]=3)),e.selectedDosages=[]}))})).catch((e=>{console.error(e)}))},fetchDoctors(){te.A.get("http://localhost:5050/api/doctors").then((e=>{this.doctorsList=e.data})).catch((e=>{console.error(e)}))},submitForm(){this.selectedMedications=this.medications.filter((e=>e.selectedDosages.length)),this.selectedMedications.push(...this.medications.customMeds);const e={patientName:this.patientName,dob:this.dob,doctorName:this.doctorName,isAdult:this.age_check(),selectedMedications:this.selectedMedications.map((e=>({name:e.name,form:e.form[0],dosages:e.selectedDosages,prescriptionMonths:e.prescriptionMonths,quantity:e.selectedQuantity,signature:e.signature})))};te.A.post("http://localhost:5050/api/print",e,{responseType:"arraybuffer"}).then((e=>{const t=new Blob([e.data]),o=URL.createObjectURL(t);this.pdf=o,console.log(o),le()(o)})).catch((e=>{console.error(e)}))}}},ae=o(1241);const ie=(0,ae.A)(ne,[["render",ee],["__scopeId","data-v-e153528c"]]);var re=ie;o(8077);const ce=(0,s.Ef)(re);ce.mount("#app")}},t={};function o(s){var l=t[s];if(void 0!==l)return l.exports;var n=t[s]={exports:{}};return e[s].call(n.exports,n,n.exports,o),n.exports}o.m=e,function(){var e=[];o.O=function(t,s,l,n){if(!s){var a=1/0;for(d=0;d<e.length;d++){s=e[d][0],l=e[d][1],n=e[d][2];for(var i=!0,r=0;r<s.length;r++)(!1&n||a>=n)&&Object.keys(o.O).every((function(e){return o.O[e](s[r])}))?s.splice(r--,1):(i=!1,n<a&&(a=n));if(i){e.splice(d--,1);var c=l();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[s,l,n]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,s){var l,n,a=s[0],i=s[1],r=s[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(l in i)o.o(i,l)&&(o.m[l]=i[l]);if(r)var d=r(o)}for(t&&t(s);c<a.length;c++)n=a[c],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(d)},s=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=o.O(void 0,[504],(function(){return o(7167)}));s=o.O(s)})();
//# sourceMappingURL=app.3d990957.js.map